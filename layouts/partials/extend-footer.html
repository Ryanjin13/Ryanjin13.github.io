<!-- Hero Background (scroll fade) -->
<div class="hero-background" id="heroBackground"></div>

<!-- Hamburger Button -->
<button class="hamburger-btn" id="menuToggle" aria-label="Toggle Menu">
  <span></span>
  <span></span>
  <span></span>
</button>

<!-- Overlay -->
<div class="menu-overlay" id="menuOverlay"></div>

<!-- Slide Menu with Categories/Subcategories -->
<nav class="slide-menu" id="slideMenu">
  <!-- Close button -->
  <button class="menu-close-btn" id="menuCloseBtn" aria-label="Close Menu">&times;</button>

  <!-- Close edge on right -->
  <div class="menu-close-edge" id="menuCloseEdge"></div>

  <div class="slide-menu-header">Categories</div>
  <ul>
    <!-- Humanoid Robot -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        <a href="{{ "categories/humanoid-robot/" | relURL }}">Humanoid Robot</a>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "tags/robot/" | relURL }}">Robot</a></li>
        <li><a href="{{ "tags/humanoid/" | relURL }}">Humanoid</a></li>
      </ul>
    </li>

    <!-- Autonomous Driving -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        <a href="{{ "categories/autonomous-driving/" | relURL }}">Autonomous Driving</a>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "tags/turtlebot3/" | relURL }}">Turtlebot3</a></li>
        <li><a href="{{ "tags/ros/" | relURL }}">ROS</a></li>
        <li><a href="{{ "tags/slam/" | relURL }}">SLAM</a></li>
        <li><a href="{{ "tags/sensor-fusion/" | relURL }}">Sensor Fusion</a></li>
        <li><a href="{{ "tags/lidar/" | relURL }}">LiDAR</a></li>
      </ul>
    </li>

    <!-- Spiking Neural Network -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        <a href="{{ "categories/spiking-neural-network/" | relURL }}">Spiking Neural Network</a>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "tags/snn/" | relURL }}">SNN</a></li>
        <li><a href="{{ "tags/neuromorphic/" | relURL }}">Neuromorphic</a></li>
        <li><a href="{{ "tags/dvs/" | relURL }}">DVS</a></li>
      </ul>
    </li>

    <!-- 3D Vision -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        <a href="{{ "categories/3d-vision/" | relURL }}">3D Vision</a>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "tags/gaussian-splatting/" | relURL }}">Gaussian Splatting</a></li>
        <li><a href="{{ "tags/nerf/" | relURL }}">NeRF</a></li>
        <li><a href="{{ "tags/3d-reconstruction/" | relURL }}">3D Reconstruction</a></li>
        <li><a href="{{ "tags/point-cloud/" | relURL }}">Point Cloud</a></li>
      </ul>
    </li>

    <!-- 2D Vision -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        <a href="{{ "categories/2d-vision/" | relURL }}">2D Vision</a>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "tags/cnn/" | relURL }}">CNN</a></li>
        <li><a href="{{ "tags/object-detection/" | relURL }}">Object Detection</a></li>
        <li><a href="{{ "tags/sam/" | relURL }}">SAM</a></li>
        <li><a href="{{ "tags/sift/" | relURL }}">SIFT</a></li>
        <li><a href="{{ "tags/stereo-matching/" | relURL }}">Stereo Matching</a></li>
      </ul>
    </li>

    <!-- AI Accelerator -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        <a href="{{ "categories/ai-accelerator/" | relURL }}">AI Accelerator</a>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "tags/quantization/" | relURL }}">Quantization</a></li>
        <li><a href="{{ "tags/pruning/" | relURL }}">Pruning</a></li>
        <li><a href="{{ "tags/distillation/" | relURL }}">Distillation</a></li>
      </ul>
    </li>

    <!-- LLM -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        <a href="{{ "categories/llm/" | relURL }}">LLM</a>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "tags/prompt-engineering/" | relURL }}">Prompt Engineering</a></li>
        <li><a href="{{ "tags/chain-of-thought/" | relURL }}">Chain of Thought</a></li>
        <li><a href="{{ "tags/rag/" | relURL }}">RAG</a></li>
      </ul>
    </li>

    <!-- Artificial Intelligence -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        <a href="{{ "categories/artificial-intelligence/" | relURL }}">Artificial Intelligence</a>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "tags/deep-learning-basic/" | relURL }}">Deep Learning Basic</a></li>
        <li><a href="{{ "tags/neural-networks/" | relURL }}">Neural Networks</a></li>
        <li><a href="{{ "tags/gradient-descent/" | relURL }}">Gradient Descent</a></li>
      </ul>
    </li>

    <!-- Computer Science -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        <a href="{{ "categories/computer-science/" | relURL }}">Computer Science</a>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "tags/programming/" | relURL }}">Programming</a></li>
        <li><a href="{{ "tags/computer-structure/" | relURL }}">Computer Structure</a></li>
        <li><a href="{{ "tags/risc-v/" | relURL }}">RISC-V</a></li>
      </ul>
    </li>

    <!-- Circuits -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        <a href="{{ "categories/circuits/" | relURL }}">Circuits</a>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "tags/analog-circuits/" | relURL }}">Analog Circuits</a></li>
        <li><a href="{{ "tags/digital-circuits/" | relURL }}">Digital Circuits</a></li>
        <li><a href="{{ "tags/lcd/" | relURL }}">LCD/Display</a></li>
        <li><a href="{{ "tags/tft/" | relURL }}">TFT</a></li>
      </ul>
    </li>

    <!-- Quantum -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        <a href="{{ "categories/quantum/" | relURL }}">Quantum</a>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "tags/quantum-mechanics/" | relURL }}">Quantum Mechanics</a></li>
        <li><a href="{{ "tags/quantum/" | relURL }}">Quantum Computing</a></li>
      </ul>
    </li>

    <!-- Math -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        <a href="{{ "categories/math/" | relURL }}">Math</a>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "tags/linear-algebra/" | relURL }}">Linear Algebra</a></li>
        <li><a href="{{ "tags/matrix-operations/" | relURL }}">Matrix Operations</a></li>
      </ul>
    </li>
  </ul>
</nav>

<script>
(function() {
  const toggle = document.getElementById('menuToggle');
  const menu = document.getElementById('slideMenu');
  const overlay = document.getElementById('menuOverlay');
  const closeBtn = document.getElementById('menuCloseBtn');
  const closeEdge = document.getElementById('menuCloseEdge');

  function openMenu() {
    toggle.classList.add('active');
    menu.classList.add('active');
    overlay.classList.add('active');
    document.body.style.overflow = 'hidden';
  }

  function closeMenu() {
    toggle.classList.remove('active');
    menu.classList.remove('active');
    overlay.classList.remove('active');
    document.body.style.overflow = '';
  }

  toggle.addEventListener('click', function() {
    if (menu.classList.contains('active')) {
      closeMenu();
    } else {
      openMenu();
    }
  });

  overlay.addEventListener('click', closeMenu);
  closeBtn.addEventListener('click', closeMenu);
  closeEdge.addEventListener('click', closeMenu);

  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') closeMenu();
  });

  // Make "Categories" link in nav open the slide menu
  document.addEventListener('DOMContentLoaded', function() {
    const navLinks = document.querySelectorAll('nav a, header a');
    navLinks.forEach(function(link) {
      if (link.textContent.trim().toLowerCase() === 'categories') {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          openMenu();
        });
      }
    });
  });

  // Expose openMenu globally
  window.openCategoryMenu = openMenu;
})();

function toggleSubcategory(el) {
  const subList = el.nextElementSibling;

  if (subList && subList.classList.contains('subcategory-list')) {
    subList.classList.toggle('show');
    el.classList.toggle('expanded');
  }
}

// Hero background fade on scroll (only fades background, no text color changes)
(function() {
  const hero = document.getElementById('heroBackground');

  const fadeStart = 0;
  const fadeEnd = window.innerHeight * 0.6;

  function updateHeroOpacity() {
    const scrollY = window.scrollY;
    let progress = (scrollY - fadeStart) / (fadeEnd - fadeStart);
    progress = Math.max(0, Math.min(1, progress));

    if (hero) {
      hero.style.opacity = 1 - progress;
    }
  }

  window.addEventListener('scroll', updateHeroOpacity);
  window.addEventListener('resize', updateHeroOpacity);
  updateHeroOpacity();
})();

// TOC active highlighting is handled by Blowfish's smartTOC feature
</script>
