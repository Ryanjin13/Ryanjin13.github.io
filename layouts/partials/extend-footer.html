<!-- Hero Background (scroll fade) -->
<div class="hero-background" id="heroBackground"></div>

<!-- Hamburger Button -->
<button class="hamburger-btn" id="menuToggle" aria-label="Toggle Menu">
  <span></span>
  <span></span>
  <span></span>
</button>

<!-- Overlay -->
<div class="menu-overlay" id="menuOverlay"></div>

<!-- Slide Menu with Categories/Subcategories -->
<nav class="slide-menu" id="slideMenu">
  <!-- Close button -->
  <button class="menu-close-btn" id="menuCloseBtn" aria-label="Close Menu">&times;</button>

  <!-- Close edge on right -->
  <div class="menu-close-edge" id="menuCloseEdge"></div>

  <div class="slide-menu-header">Categories</div>
  <ul>
    <!-- Humanoid Robot -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        Humanoid Robot
        <span class="count">(1)</span>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "categories/humanoid-robot/" | relURL }}">Robot Basic <span class="count">(1)</span></a></li>
      </ul>
    </li>

    <!-- Autonomous Driving -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        Autonomous Driving
        <span class="count">(1)</span>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "categories/autonomous-driving/" | relURL }}">Turtlebot3 <span class="count">(1)</span></a></li>
        <li><a href="{{ "categories/autonomous-driving/" | relURL }}">Carla <span class="count">(0)</span></a></li>
        <li><a href="{{ "categories/autonomous-driving/" | relURL }}">Cybersecurity <span class="count">(0)</span></a></li>
      </ul>
    </li>

    <!-- Spiking Neural Network -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        Spiking Neural Network
        <span class="count">(1)</span>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "categories/spiking-neural-network/" | relURL }}">SNN Basic <span class="count">(1)</span></a></li>
        <li><a href="{{ "categories/spiking-neural-network/" | relURL }}">STDP <span class="count">(0)</span></a></li>
        <li><a href="{{ "categories/spiking-neural-network/" | relURL }}">Transformers <span class="count">(0)</span></a></li>
      </ul>
    </li>

    <!-- 3D Vision -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        3D Vision
        <span class="count">(1)</span>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "categories/3d-vision/" | relURL }}">Gaussian Splatting <span class="count">(1)</span></a></li>
        <li><a href="{{ "categories/3d-vision/" | relURL }}">NeRF <span class="count">(0)</span></a></li>
        <li><a href="{{ "categories/3d-vision/" | relURL }}">3D Reconstruction <span class="count">(0)</span></a></li>
      </ul>
    </li>

    <!-- 2D Vision -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        2D Vision
        <span class="count">(1)</span>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "categories/2d-vision/" | relURL }}">SAM <span class="count">(1)</span></a></li>
        <li><a href="{{ "categories/2d-vision/" | relURL }}">Object Detection <span class="count">(0)</span></a></li>
        <li><a href="{{ "categories/2d-vision/" | relURL }}">Vision Basic <span class="count">(0)</span></a></li>
      </ul>
    </li>

    <!-- AI Accelerator -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        AI Accelerator
        <span class="count">(1)</span>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "categories/ai-accelerator/" | relURL }}">Quantization <span class="count">(1)</span></a></li>
        <li><a href="{{ "categories/ai-accelerator/" | relURL }}">Pruning <span class="count">(0)</span></a></li>
        <li><a href="{{ "categories/ai-accelerator/" | relURL }}">Distillation <span class="count">(0)</span></a></li>
      </ul>
    </li>

    <!-- LLM -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        LLM
        <span class="count">(1)</span>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "categories/llm/" | relURL }}">Prompt Engineering <span class="count">(1)</span></a></li>
      </ul>
    </li>

    <!-- Artificial Intelligence -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        Artificial Intelligence
        <span class="count">(1)</span>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "categories/artificial-intelligence/" | relURL }}">Deep Learning Basic <span class="count">(1)</span></a></li>
      </ul>
    </li>

    <!-- Computer Science -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        Computer Science
        <span class="count">(1)</span>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "categories/computer-science/" | relURL }}">Programming <span class="count">(1)</span></a></li>
        <li><a href="{{ "categories/computer-science/" | relURL }}">Algorithms <span class="count">(0)</span></a></li>
      </ul>
    </li>

    <!-- Circuits -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        Circuits
        <span class="count">(1)</span>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "categories/circuits/" | relURL }}">Circuit Design <span class="count">(1)</span></a></li>
      </ul>
    </li>

    <!-- Quantum -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        Quantum
        <span class="count">(1)</span>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "categories/quantum/" | relURL }}">Quantum Computing <span class="count">(1)</span></a></li>
      </ul>
    </li>

    <!-- Math -->
    <li>
      <div class="category-main" onclick="toggleSubcategory(this)">
        <span class="toggle">▶</span>
        Math
        <span class="count">(1)</span>
      </div>
      <ul class="subcategory-list">
        <li><a href="{{ "categories/math/" | relURL }}">Linear Algebra <span class="count">(1)</span></a></li>
      </ul>
    </li>
  </ul>
</nav>

<script>
(function() {
  const toggle = document.getElementById('menuToggle');
  const menu = document.getElementById('slideMenu');
  const overlay = document.getElementById('menuOverlay');
  const closeBtn = document.getElementById('menuCloseBtn');
  const closeEdge = document.getElementById('menuCloseEdge');

  function openMenu() {
    toggle.classList.add('active');
    menu.classList.add('active');
    overlay.classList.add('active');
    document.body.style.overflow = 'hidden';
  }

  function closeMenu() {
    toggle.classList.remove('active');
    menu.classList.remove('active');
    overlay.classList.remove('active');
    document.body.style.overflow = '';
  }

  toggle.addEventListener('click', function() {
    if (menu.classList.contains('active')) {
      closeMenu();
    } else {
      openMenu();
    }
  });

  overlay.addEventListener('click', closeMenu);
  closeBtn.addEventListener('click', closeMenu);
  closeEdge.addEventListener('click', closeMenu);

  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') closeMenu();
  });

  // Make "Categories" link in nav open the slide menu
  document.addEventListener('DOMContentLoaded', function() {
    const navLinks = document.querySelectorAll('nav a, header a');
    navLinks.forEach(function(link) {
      if (link.textContent.trim().toLowerCase() === 'categories') {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          openMenu();
        });
      }
    });
  });

  // Expose openMenu globally
  window.openCategoryMenu = openMenu;
})();

function toggleSubcategory(el) {
  const subList = el.nextElementSibling;

  if (subList && subList.classList.contains('subcategory-list')) {
    subList.classList.toggle('show');
    el.classList.toggle('expanded');
  }
}

// Hero background fade on scroll
(function() {
  const hero = document.getElementById('heroBackground');
  if (!hero) return;

  const fadeStart = 0;
  const fadeEnd = window.innerHeight * 0.8;

  function updateOpacity() {
    const scrollY = window.scrollY;
    let opacity = 1 - (scrollY - fadeStart) / (fadeEnd - fadeStart);
    opacity = Math.max(0, Math.min(1, opacity));
    hero.style.opacity = opacity;
  }

  window.addEventListener('scroll', updateOpacity);
  updateOpacity();
})();
</script>
